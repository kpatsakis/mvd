static int unix_bind(struct socket *sock, struct sockaddr *uaddr, int addr_len) struct sockaddr_un * sunaddr = ( struct sockaddr_un * ) uaddr ; int err , name_err ; if ( sunaddr -> sun_family != AF_UNIX )  if ( addr_len == sizeof ( short ) )  err = unix_mkname ( sunaddr , addr_len , & hash ); static int unix_mkname(struct sockaddr_un *sunaddr, int len, unsigned int *hashp) if ( len <= sizeof ( short ) || len > sizeof ( * sunaddr ) )  if ( ! sunaddr || sunaddr -> sun_family != AF_UNIX )  if ( sunaddr -> sun_path [ 0 ] )  ( ( char * ) sunaddr ) [ len ] = 0; len = strlen ( sunaddr -> sun_path ) + 1 + sizeof ( short ); return len ; 