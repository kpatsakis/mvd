static int usb_xhci_post_load(void *opaque, int version_id) XHCIState * xhci = opaque ; PCIDevice * pci_dev = PCI_DEVICE ( xhci ) ; XHCISlot * slot ; dma_addr_t dcbaap , pctx ; uint32_t slot_ctx [ 4 ] ; int slotid , epid , state , intr ; dcbaap = xhci_addr64 ( xhci -> dcbaap_low , xhci -> dcbaap_high ); for (slotid = 1; slotid <= xhci->numslots; slotid++) slot = & xhci -> slots [ slotid - 1 ]; if ( ! slot -> addressed )  slot -> ctx = xhci_mask64 ( ldq_le_pci_dma ( pci_dev , dcbaap + 8 * slotid ) ); xhci_dma_read_u32s ( xhci , slot -> ctx , slot_ctx , sizeof ( slot_ctx ) ); slot -> uport = xhci_lookup_uport ( xhci , slot_ctx ); if ( ! slot -> uport )  slot -> enabled = 0; slot -> addressed = 0; static inline void xhci_dma_read_u32s(XHCIState *xhci, dma_addr_t uint32_t *buf, size_t len) assert ( ( len % sizeof ( uint32_t ) ) == 0 ); 