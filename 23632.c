 CVE_2013_0782_VULN_nsSaveAsCharset::HandleFallBack(uint32_t character, char **outString, int32_t int32_t *currentPos, int32_t estimatedLength) char fallbackStr [ 256 ] ; nsresult rv = DoConversionFallBack ( character , fallbackStr , 256 ) ; if ( NS_SUCCEEDED ( rv ) )  int32_t tempLen = ( int32_t ) PL_strlen ( fallbackStr ) ; if ( ( tempLen + estimatedLength ) >= ( * bufferLength - * currentPos ) )  char * temp = ( char * ) PR_Realloc ( * outString , * bufferLength + tempLen ) ; if ( temp )  * outString = temp; memcpy ( ( * outString + * currentPos ) , fallbackStr , tempLen ); 