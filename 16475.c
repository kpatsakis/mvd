static int CVE_2012_6617_PATCHED_prepare_sdp_description(FFStream *stream, uint8_t struct in_addr my_ip) AVFormatContext * avc ; AVOutputFormat * rtp_format = av_guess_format ( "rtp" , NULL , NULL ) ; avc = avformat_alloc_context ( ); if ( avc == NULL || ! rtp_format )  avc -> oformat = rtp_format; avc -> nb_streams = stream -> nb_streams; if ( stream -> is_multicast )  snprintf ( avc -> filename , 1024 , "rtp://%s:%d?multicast=1?ttl=%d" , inet_ntoa ( stream -> multicast_ip ) , stream -> multicast_port , stream -> multicast_ttl ); 